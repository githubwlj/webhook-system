{
  "permissions": {
    "allow": [
      "Bash(npm install:*)",
      "Bash(npm start)",
      "Bash(lsof:*)",
      "Bash(kill:*)",
      "Bash(PORT=6999 npm start)",
      "Bash(curl:*)",
      "Bash(chmod:*)",
      "Bash(./test_system.sh:*)",
      "Bash(node:*)",
      "Bash(pkill:*)",
      "Bash(./captcha_report.sh:*)",
      "Bash(./fix_report.sh)",
      "Bash(pm2 restart:*)",
      "Bash(pm2 list:*)",
      "Bash(pm2 stop:*)",
      "Bash(pm2 delete:*)",
      "Bash(pm2 start:*)",
      "Bash(pm2 logs:*)",
      "Bash(rm:*)",
      "Bash(# 3. æµ‹è¯•ç®¡ç†å‘˜ä»¤ç‰Œé™åˆ¶\necho \"\"ğŸ‘‘ æµ‹è¯•ç®¡ç†å‘˜ä»¤ç‰Œé™åˆ¶...\"\"\n\n# å°è¯•åˆ›å»ºç¬¬ä¸€ä¸ªç®¡ç†å‘˜ä»¤ç‰Œ\nADMIN_RESPONSE1=$(curl -s -X POST \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"name\"\":\"\"admin-token-1\"\",\"\"type\"\":\"\"admin\"\",\"\"description\"\":\"\"ç¬¬ä¸€ä¸ªç®¡ç†å‘˜ä»¤ç‰Œ\"\"}'')\n\nif echo \"\"$ADMIN_RESPONSE1\"\" | grep -q ''\"\"success\"\":true''; then\n    echo \"\"âœ… ç¬¬ä¸€ä¸ªç®¡ç†å‘˜ä»¤ç‰Œåˆ›å»ºæˆåŠŸ\"\"\nelse\n    echo \"\"âŒ ç¬¬ä¸€ä¸ªç®¡ç†å‘˜ä»¤ç‰Œåˆ›å»ºå¤±è´¥: $ADMIN_RESPONSE1\"\"\nfi\n\n# å°è¯•åˆ›å»ºç¬¬äºŒä¸ªç®¡ç†å‘˜ä»¤ç‰Œ\nADMIN_RESPONSE2=$(curl -s -X POST \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"name\"\":\"\"admin-token-2\"\",\"\"type\"\":\"\"admin\"\",\"\"description\"\":\"\"ç¬¬äºŒä¸ªç®¡ç†å‘˜ä»¤ç‰Œ\"\"}'')\n\nif echo \"\"$ADMIN_RESPONSE2\"\" | grep -q \"\"åªèƒ½å­˜åœ¨ä¸€ä¸ªç®¡ç†å‘˜ä»¤ç‰Œ\"\"; then\n    echo \"\"âœ… ç®¡ç†å‘˜ä»¤ç‰Œé™åˆ¶éªŒè¯é€šè¿‡\"\"\nelse\n    echo \"\"âŒ ç®¡ç†å‘˜ä»¤ç‰Œé™åˆ¶éªŒè¯å¤±è´¥: $ADMIN_RESPONSE2\"\"\nfi)",
      "Bash(# æ£€æŸ¥ä»¤ç‰Œåˆ›å»ºé”™è¯¯è¯¦æƒ…\ncurl -s -X POST \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"name\"\":\"\"admin-token-1\"\",\"\"type\"\":\"\"admin\"\",\"\"description\"\":\"\"æµ‹è¯•ç®¡ç†å‘˜ä»¤ç‰Œ\"\"}'' -w \"\"\\nHTTP Status: %{http_code}\\n\"\")",
      "Bash(echo)",
      "Bash(# 1. åˆ›å»ºç®¡ç†å‘˜ä»¤ç‰Œ\necho \"\"ğŸ‘‘ åˆ›å»ºç®¡ç†å‘˜ä»¤ç‰Œ...\"\"\nADMIN_TOKEN=$(curl -s -X POST \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"name\"\":\"\"Admin\"\",\"\"type\"\":\"\"admin\"\",\"\"description\"\":\"\"ç³»ç»Ÿç®¡ç†å‘˜ä»¤ç‰Œï¼Œæ‹¥æœ‰å®Œå…¨è®¿é—®æƒé™\"\"}'')\n\nif echo \"\"$ADMIN_TOKEN\"\" | grep -q ''\"\"success\"\":true''; then\n    echo \"\"âœ… ç®¡ç†å‘˜ä»¤ç‰Œåˆ›å»ºæˆåŠŸ\"\"\n    ADMIN_VALUE=$(echo \"\"$ADMIN_TOKEN\"\" | grep -o ''\"\"value\"\":\"\"[^\"\"]*\"\"'' | cut -d''\"\"'' -f4)\n    echo \"\"   ä»¤ç‰Œå€¼: ${ADMIN_VALUE:0:20}...\"\"\nelse\n    echo \"\"âŒ ç®¡ç†å‘˜ä»¤ç‰Œåˆ›å»ºå¤±è´¥: $ADMIN_TOKEN\"\"\nfi)",
      "Bash(# 2. UIè®¿é—®ä»¤ç‰Œ\necho \"\"ğŸ–¥ï¸ åˆ›å»ºUIè®¿é—®ä»¤ç‰Œ...\"\"\nUI_RESULT=$(curl -s -X POST \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"name\"\":\"\"UI-Access\"\",\"\"type\"\":\"\"ui_access\"\",\"\"description\"\":\"\"å‰ç«¯ç•Œé¢è®¿é—®ä»¤ç‰Œï¼Œä»…å¯è®¿é—®ç›‘æ§é¡µé¢\"\"}'')\n\nif echo \"\"$UI_RESULT\"\" | grep -q ''\"\"success\"\":true''; then\n    echo \"\"âœ… UIè®¿é—®ä»¤ç‰Œåˆ›å»ºæˆåŠŸ\"\"\nelse\n    echo \"\"âŒ UIè®¿é—®ä»¤ç‰Œåˆ›å»ºå¤±è´¥: $UI_RESULT\"\"\nfi\n\n# 3. APIè®¿é—®ä»¤ç‰Œ\necho \"\"ğŸ”Œ åˆ›å»ºAPIè®¿é—®ä»¤ç‰Œ...\"\"\nAPI_RESULT=$(curl -s -X POST \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"name\"\":\"\"API-Access\"\",\"\"type\"\":\"\"api_access\"\",\"\"description\"\":\"\"APIæ¥å£è®¿é—®ä»¤ç‰Œï¼Œå¯è°ƒç”¨ç³»ç»ŸAPI\"\"}'')\n\nif echo \"\"$API_RESULT\"\" | grep -q ''\"\"success\"\":true''; then\n    echo \"\"âœ… APIè®¿é—®ä»¤ç‰Œåˆ›å»ºæˆåŠŸ\"\"\nelse\n    echo \"\"âŒ APIè®¿é—®ä»¤ç‰Œåˆ›å»ºå¤±è´¥: $API_RESULT\"\"\nfi)",
      "Bash(# 4. Webhookå¯†é’¥ä»¤ç‰Œ\necho \"\"ğŸ” åˆ›å»ºWebhookå¯†é’¥ä»¤ç‰Œ...\"\"\nWEBHOOK_RESULT=$(curl -s -X POST \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"name\"\":\"\"Webhook-Secret\"\",\"\"type\"\":\"\"webhook_secret\"\",\"\"description\"\":\"\"Webhookç­¾åéªŒè¯å¯†é’¥\"\"}'')\n\nif echo \"\"$WEBHOOK_RESULT\"\" | grep -q ''\"\"success\"\":true''; then\n    echo \"\"âœ… Webhookå¯†é’¥ä»¤ç‰Œåˆ›å»ºæˆåŠŸ\"\"\nelse\n    echo \"\"âŒ Webhookå¯†é’¥ä»¤ç‰Œåˆ›å»ºå¤±è´¥\"\"\nfi\n\necho \"\"\"\"\necho \"\"ğŸ“‹ æŸ¥çœ‹å½“å‰ä»¤ç‰Œåˆ—è¡¨...\"\"\ncurl -s -X GET \"\"$BASE_URL/admin/tokens\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\" | python3 -m json.tool 2>/dev/null || echo \"\"ä»¤ç‰Œåˆ—è¡¨è·å–å¤±è´¥\"\")",
      "Bash(# 2. åˆ›å»ºæµ‹è¯•webhookæ¥æ”¶å™¨å¹¶å‘é€æ¶ˆæ¯\necho \"\"2. åˆ›å»ºæµ‹è¯•webhookæ¥æ”¶å™¨...\"\"\ncurl -s -X POST \"\"$BASE_URL/webhook/config/receiver\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\n        \"\"id\"\": \"\"test-logs\"\",\n        \"\"description\"\": \"\"æµ‹è¯•æ—¥å¿—æ¥æ”¶å™¨\"\"\n    }'' > /dev/null\n\necho \"\"âœ… æµ‹è¯•webhookæ¥æ”¶å™¨å·²åˆ›å»º\"\"\n\n# 3. å‘é€å¤šæ¡æµ‹è¯•æ¶ˆæ¯\necho \"\"3. å‘é€åº”ç”¨æ´»åŠ¨æ¶ˆæ¯...\"\"\ncurl -s -X POST \"\"$BASE_URL/webhook/receive/test-logs\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\n        \"\"event\"\": \"\"user_activity\"\",\n        \"\"message\"\": \"\"ç”¨æˆ·ç™»å½•ç³»ç»Ÿ\"\",\n        \"\"user\"\": \"\"admin\"\",\n        \"\"ip\"\": \"\"127.0.0.1\"\",\n        \"\"timestamp\"\": \"\"''$(date -Iseconds)''\"\"\n    }'' > /dev/null\n\nsleep 1\n\necho \"\"4. å‘é€æ€§èƒ½ç›‘æ§æ¶ˆæ¯...\"\"\ncurl -s -X POST \"\"$BASE_URL/webhook/receive/test-logs\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\n        \"\"event\"\": \"\"performance_metrics\"\",\n        \"\"message\"\": \"\"ç³»ç»Ÿæ€§èƒ½æŠ¥å‘Š\"\",\n        \"\"cpu_usage\"\": \"\"15%\"\",\n        \"\"memory_usage\"\": \"\"68%\"\",\n        \"\"active_connections\"\": 42,\n        \"\"timestamp\"\": \"\"''$(date -Iseconds)''\"\"\n    }'' > /dev/null)",
      "Bash(# æµ‹è¯•2: ä½¿ç”¨æŒ‡å®šæ¥æ”¶å™¨ï¼Œå¸¦Bearerå‡­è¯\necho \"\"ğŸ“¡ æµ‹è¯•2: æŒ‡å®šæ¥æ”¶å™¨ï¼Œå¸¦Bearerå‡­è¯\"\"\necho \"\"åœ°å€: $BASE_URL/webhook/receive/test-logs\"\"\necho \"\"å‡­è¯: Bearer cf3346a1f6b872db50875869f859bf6f1b8ece3d3251f860482ac004ab2eb613\"\"\n\nRESPONSE2=$(curl -s -X POST \"\"$BASE_URL/webhook/receive/test-logs\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -H \"\"Authorization: Bearer cf3346a1f6b872db50875869f859bf6f1b8ece3d3251f860482ac004ab2eb613\"\" \\\n    -d ''{\n        \"\"type\"\": \"\"quota_exceed\"\",\n        \"\"title\"\": \"\"é¢åº¦é¢„è­¦é€šçŸ¥\"\",\n        \"\"content\"\": \"\"æ‚¨çš„é¢åº¦å³å°†ç”¨å°½ï¼Œå½“å‰å‰©ä½™é¢åº¦ä¸º {{value}}\"\",\n        \"\"values\"\": [\"\"$0.99\"\"],\n        \"\"timestamp\"\": 1739950503\n    }'')\n\nif echo \"\"$RESPONSE2\"\" | grep -q ''\"\"success\"\":true''; then\n    echo \"\"âœ… æˆåŠŸæ¥æ”¶\"\"\nelse\n    echo \"\"âŒ æ¥æ”¶å¤±è´¥\"\"\nfi\n\necho \"\"$RESPONSE2\"\" | head -1\necho \"\"\"\")",
      "Bash(# æµ‹è¯•3: æ›´å¤šç±»å‹çš„é€šçŸ¥æµ‹è¯•\necho \"\"ğŸ“¡ æµ‹è¯•3: ä¸åŒç±»å‹é€šçŸ¥\"\"\n\n# è´¦å•é€šçŸ¥\necho \"\"ğŸ’° è´¦å•åˆ°æœŸé€šçŸ¥...\"\"\ncurl -s -X POST \"\"$BASE_URL/webhook\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\n        \"\"type\"\": \"\"bill_due\"\",\n        \"\"title\"\": \"\"è´¦å•åˆ°æœŸæé†’\"\",\n        \"\"content\"\": \"\"æ‚¨çš„{{value}}è´¦å•å°†åœ¨{{value}}å¤©ååˆ°æœŸï¼Œé‡‘é¢ä¸º{{value}}\"\",\n        \"\"values\"\": [\"\"2025å¹´1æœˆ\"\", \"\"7\"\", \"\"$129.99\"\"],\n        \"\"timestamp\"\": ''$(date +%s)''\n    }'' > /dev/null\n\n# ç³»ç»Ÿç»´æŠ¤é€šçŸ¥\necho \"\"ğŸ”§ ç³»ç»Ÿç»´æŠ¤é€šçŸ¥...\"\"\ncurl -s -X POST \"\"$BASE_URL/webhook\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\n        \"\"type\"\": \"\"maintenance\"\",\n        \"\"title\"\": \"\"ç³»ç»Ÿç»´æŠ¤é€šçŸ¥\"\",\n        \"\"content\"\": \"\"ç³»ç»Ÿå°†äº{{value}}è¿›è¡Œç»´æŠ¤ï¼Œé¢„è®¡æŒç»­{{value}}å°æ—¶\"\",\n        \"\"values\"\": [\"\"2025-01-15 02:00\"\", \"\"2\"\"],\n        \"\"timestamp\"\": ''$(date +%s)''\n    }'' > /dev/null\n\n# å®‰å…¨è­¦å‘Š\necho \"\"ğŸš¨ å®‰å…¨è­¦å‘Š...\"\"\ncurl -s -X POST \"\"$BASE_URL/webhook\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\n        \"\"type\"\": \"\"security_alert\"\",\n        \"\"title\"\": \"\"å®‰å…¨è­¦å‘Š\"\",\n        \"\"content\"\": \"\"æ£€æµ‹åˆ°å¼‚å¸¸ç™»å½•å°è¯•ï¼Œæ¥æºIPï¼š{{value}}ï¼Œå°è¯•æ¬¡æ•°ï¼š{{value}}\"\",\n        \"\"values\"\": [\"\"192.168.1.100\"\", \"\"5\"\"],\n        \"\"timestamp\"\": ''$(date +%s)''\n    }'' > /dev/null\n\necho \"\"âœ… å¤šç§ç±»å‹é€šçŸ¥å‘é€å®Œæˆ\"\"\necho \"\"\"\")",
      "Bash(# éªŒè¯webhookæ—¥å¿—API\nBASE_URL=\"\"http://localhost:6997\"\"\n\n# è·å–ç®¡ç†å‘˜ä»¤ç‰Œ\nLOGIN_RESPONSE=$(curl -s -X POST \"\"$BASE_URL/admin/login\"\" \\\n    -H \"\"Content-Type: application/json\"\" \\\n    -d ''{\"\"username\"\":\"\"admin\"\",\"\"password\"\":\"\"admin123\"\",\"\"captcha\"\":\"\"12345\"\"}'')\nTOKEN=$(echo \"\"$LOGIN_RESPONSE\"\" | grep -o ''\"\"token\"\":\"\"[^\"\"]*\"\"'' | cut -d''\"\"'' -f4)\n\necho \"\"ğŸ” éªŒè¯webhookæ—¥å¿—API...\"\"\n\n# è°ƒç”¨webhookæ—¥å¿—API\nLOGS_RESPONSE=$(curl -s -X GET \"\"$BASE_URL/webhook/logs?limit=5\"\" \\\n    -H \"\"Authorization: Bearer $TOKEN\"\")\n\necho \"\"ğŸ“Š APIè¿”å›æ•°æ®é¢„è§ˆ:\"\"\necho \"\"$LOGS_RESPONSE\"\" | jq ''.logs | length'' 2>/dev/null || echo \"\"æ— æ³•è§£æJSON\"\"\necho \"\"\"\"\n\nif echo \"\"$LOGS_RESPONSE\"\" | grep -q ''\"\"logs\"\"''; then\n    echo \"\"âœ… Webhookæ—¥å¿—APIå·¥ä½œæ­£å¸¸\"\"\n    \n    # ç»Ÿè®¡æ—¥å¿—æ•°é‡\n    LOG_COUNT=$(echo \"\"$LOGS_RESPONSE\"\" | grep -o ''{\"\"id\"\"'' | wc -l)\n    echo \"\"ğŸ“ˆ è¿”å›çš„æ—¥å¿—æ¡æ•°: $LOG_COUNT\"\"\n    \n    # æ˜¾ç¤ºç¬¬ä¸€æ¡æ—¥å¿—çš„ç±»å‹\n    FIRST_TYPE=$(echo \"\"$LOGS_RESPONSE\"\" | grep -o ''\"\"type\"\":\"\"[^\"\"]*\"\"'' | head -1 | cut -d''\"\"'' -f4)\n    echo \"\"ğŸ·ï¸ æœ€æ–°æ—¥å¿—ç±»å‹: $FIRST_TYPE\"\"\nelse\n    echo \"\"âŒ Webhookæ—¥å¿—APIè¿”å›å¼‚å¸¸\"\"\n    echo \"\"è¿”å›å†…å®¹: $LOGS_RESPONSE\"\"\nfi)",
      "Bash(__NEW_LINE__ echo \"âœ… æˆåŠŸçš„é…ç½®æ–¹æ¡ˆï¼š\")",
      "Bash(__NEW_LINE__ echo \"ğŸ”‘ æ¥å£å‡­è¯é…ç½®ï¼š\")",
      "Bash(__NEW_LINE__ echo \"ğŸ“‹ åœ¨ç¬¬ä¸‰æ–¹ç³»ç»Ÿä¸­çš„é…ç½®ç¤ºä¾‹ï¼š\")",
      "Bash(__NEW_LINE__ echo \"ğŸ¯ æ”¯æŒçš„é€šçŸ¥ç±»å‹ï¼š\")",
      "Bash(__NEW_LINE__ echo \"ğŸ” æŸ¥çœ‹æ¥æ”¶åˆ°çš„é€šçŸ¥ï¼š\")",
      "Bash(fuser:*)",
      "Bash(PORT=6997 npm start)",
      "Bash(./test_enhanced_webhooks.sh:*)",
      "Bash(npm run restart:production:*)",
      "Bash(./restart-production.sh:*)",
      "Bash(find:*)",
      "Bash(docker exec:*)",
      "Bash(systemctl stop:*)",
      "Bash(systemctl:*)",
      "Bash(pm2 status:*)",
      "Bash(git init:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git remote add:*)",
      "Bash(git push:*)",
      "Bash(git remote set-url:*)",
      "Bash(npm restart)",
      "Bash(grep:*)",
      "Bash(sed:*)",
      "Bash(./status_report.sh)",
      "Bash(true)",
      "Bash(npm run:*)",
      "Bash(NODE_ENV=development npm run pm2:restart)",
      "Bash(nginx:*)",
      "Bash(/usr/local/openresty/bin/openresty:*)",
      "Bash(ls:*)",
      "Bash(openresty:*)",
      "Bash(cat:*)"
    ],
    "deny": []
  }
}